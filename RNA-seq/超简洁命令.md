* [RNA-seq 流程常用代码整理](#RNA-seq 流程常用代码整理)
      * [1. 前期准备](#1-前期准备)
      * [2. 工具下载](#2-工具下载)
         * [2.0 生信管理工具](#20-生信管理工具)
         * [2.1 sratoolkit](#21-sratoolkit)
         * [2.2 fastqc](#22-fastqc)
         * [2.3 multiqc](#23-multiqc)
         * [2.4 cutadapt](#24-cutadapt)
         * [2.5 trimmomatic](#25-trimmomatic)
         * [2.6 hisat2](#26-hisat2)
         * [sortmerna](#sortmerna)
         * [2.7 samtools](#27-samtools)
         * [2.8 HTseq](#28-htseq)
         * [2.9 R](#29-r)
# RNA-seq 流程常用代码整理   

## 数据下载
1. 在 ensemble 中下载基因组数据  

* 注：记得先 1. 建好数据存储文件夹  2. 在网页上看清所需数据是`toplevel`还是`primary assembly`及其版本号再下载  

* 具体用法  
```
cd 存储文件夹
wget 官网上的物种基因组文件.fa.gz

mv 基因组文件.fa  简单名称.fa
```
* 举例  

```
# 下载
cd /mnt/d/project/rat/genome
wget http://ftp.ensembl.org/pub/release-107/fasta/rattus_norvegicus/dna/Rattus_norvegicus.mRatBN7.2.dna.toplevel.fa.gz
gzip -d Rattus_norvegicus.mRatBN7.2.dna.toplevel.fa.gz

# 改名（方便后面使用，名字太长一来不方便输入，二来可能会输错）
mv Rattus_norvegicus.mRatBN7.2.dna.toplevel.fa mRatBN7.2.fa
```

2. 下载基因组索引文件  
在hisat2 官网上可以找到现成的已经建立好索引的模式生物的基因组文件  
* 具体用法  
```
cd 数据存储文件
wget hisat2 官网上的文件.tar.gz 
gzip -d 保存文件名称.tar
```
* 以大鼠基因举例:    
```
cd /mnt/d/database
wget https://genome-idx.s3.amazonaws.com/hisat/rn6_genome.tar.gz
gzip -d rn6.tar
```  
3. 下载注释信息  
与`下载基因组文件类似`  

## 整理、统计基因组数据等  

1. 去除染色体后描述信息  

* 具体用法
```
cat 基因组数据.fa | perl -n -e 'if(m/^>(.+?)(?:\s|$)/){ print ">$1\n";}else{print}' > 输出文件.fa
```
* 举例  
```
cat mRatBN7.2.raw.fa | perl -n -e 'if(m/^>(.+?)(?:\s|$)/){ print ">$1\n";}else{print}' > mRatBN7.2.fa
```  
2. 统计每一条染色体的长度  
* 举例  
```
cat 输入文件 | perl -n -e '
    s/\r?\n//;
    if(m/^>(.+?)\s*$/){
        $title = $1;
        push @t, $title;
    }elsif(defined $title){
        $title_len{$title} += length($_);
    }
    END{
        for my $title (@t){
            print "$title","\t","$title_len{$title}","\n";
        }
    }
'
```




